<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cassa 2026 Pro</title>
<link rel="stylesheet" href="style.css">
<link rel="manifest" href="manifest.json">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f2f4f8; color:#000;}
.dark { background:#121212; color:#f2f4f8;}
header { padding:10px; background:#2563eb; color:white; text-align:center;}
section { padding:15px; display:none;}
nav { display:flex; justify-content:space-around; background:#eee; padding:10px; position:fixed; bottom:0; width:100%;}
button { padding:5px 10px; margin:5px;}
input, select { padding:5px; margin:5px;}
#loginScreen { display:block; padding:50px; text-align:center;}
.toggle-btn { margin-left:5px;}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginScreen">
  <h2>Benvenuto in Cassa 2026</h2>
  <input type="text" id="pinInput" placeholder="Inserisci PIN">
  <button id="btnAccedi">Accedi</button>
  <p id="loginMsg" style="color:red;"></p>
</div>

<!-- APP -->
<div id="app" style="display:none;">

  <header>
    <h1>Cassa 2026 Pro</h1>
    <button id="darkToggle">üåô Dark Mode</button>
    <button id="toggleSaldo">üëÅÔ∏è Toggle Saldo</button>
  </header>

  <!-- SEZIONE HOME -->
  <section id="homeSection">
    <h2>Saldo Totale</h2>
    <p id="saldoTot">‚Ç¨0</p>
    <p>Ingressi: <span id="totIn">‚Ç¨0</span> | Spese: <span id="totSp">‚Ç¨0</span></p>
    <canvas id="grafico" width="400" height="150"></canvas>
  </section>

  <!-- SEZIONE MOVIMENTI -->
  <section id="movimentiSection">
    <h2>Nuovo Movimento</h2>
    <input type="text" id="descMov" placeholder="Descrizione">
    <input type="number" id="importoMov" placeholder="Importo">
    <select id="tipoMov">
      <option value="ingresso">Ingresso</option>
      <option value="spesa">Spesa</option>
    </select>
    <button onclick="aggiungiMovimento()">Aggiungi</button>

    <h3>Filtri</h3>
    <select id="filtroData" onchange="gestisciPeriodoPicker()">
      <option value="anno">Tutto l'anno</option>
      <option value="mese">Mese corrente</option>
      <option value="periodo">Da giorno X a giorno Y</option>
    </select>
    <div id="periodoPicker" style="display:none;">
      <input type="date" id="dataInizio">
      <input type="date" id="dataFine">
      <button onclick="applicaFiltri()">Applica</button>
    </div>
    <select id="filtroCategoria" onchange="applicaFiltri()">
      <option value="tutte">Tutte le categorie</option>
      <option value="ingresso">Ingresso</option>
      <option value="spesa">Spesa</option>
    </select>

    <div id="lista"></div>
  </section>

  <!-- SEZIONE OBIETTIVI -->
  <section id="obiettiviSection">
    <h2>Obiettivi</h2>
    <input type="number" id="obiettivoGuadagno" placeholder="Obiettivo Guadagno">
    <input type="number" id="obiettivoSpesa" placeholder="Obiettivo Spesa">
    <button onclick="salvaObiettivi()">Salva Obiettivi</button>
    <div id="statusObiettivi"></div>
  </section>

  <!-- SEZIONE IMPOSTAZIONI -->
  <section id="impostazioniSection">
    <h2>Impostazioni</h2>
    <button onclick="resetApp()">Reset App (AUTOOF)</button>
  </section>

  <nav>
    <button onclick="apriSezione('home')">Home</button>
    <button onclick="apriSezione('movimenti')">Movimenti</button>
    <button onclick="apriSezione('obiettivi')">Obiettivi</button>
    <button onclick="apriSezione('impostazioni')">Impostazioni</button>
  </nav>

</div>

<script src="script.js"></script>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js')
    .then(() => console.log('Service Worker registrato con successo!'))
    .catch(err => console.log('Errore Service Worker:', err));
}
</script>
</body>
</html>
